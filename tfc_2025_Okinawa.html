<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TFC 13Y 沖繩四日遊行程總覽</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #F8F7F4;
            color: #3D405B;
        }
        .nav-link {
            transition: all 0.3s;
        }
        .nav-link.active {
            color: #E07A5F;
            border-bottom: 2px solid #E07A5F;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            top: 2rem;
            left: -0.8rem; /* Mobile */
            width: 2px;
            height: calc(100% - 1rem);
            background-color: #81B29A;
        }
        .timeline-icon {
            position: absolute;
            left: -1.5rem; /* Mobile */
            top: 1.5rem;
            width: 2rem; /* Mobile */
            height: 2rem; /* Mobile */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #81B29A;
            color: white;
            z-index: 10;
        }
        .option-tab {
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        .option-tab.active {
            background-color: #81B29A;
            color: white;
            border-color: #81B29A;
        }
        .option-tab:not(.active) {
             background-color: #F4F1DE;
             color: #3D405B;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .timeline-item::before {
                left: -1.05rem;
            }
            .timeline-icon {
                left: -2rem;
                width: 2.5rem;
                height: 2.5rem;
            }
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex flex-col">
                    <h1 class="text-2xl md:text-3xl font-bold text-[#3D405B]">TFC 13Y 沖繩之旅</h1>
                    <p class="text-sm text-gray-500">四天三夜，十人同行，一場難忘的旅遊</p>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <a href="#overview" class="nav-link text-lg font-medium text-gray-600 hover:text-[#E07A5F] pb-1">總覽</a>
                    <a href="#day1" class="nav-link text-lg font-medium text-gray-600 hover:text-[#E07A5F] pb-1">Day 1</a>
                    <a href="#day2" class="nav-link text-lg font-medium text-gray-600 hover:text-[#E07A5F] pb-1">Day 2</a>
                    <a href="#day3" class="nav-link text-lg font-medium text-gray-600 hover:text-[#E07A5F] pb-1">Day 3</a>
                    <a href="#day4" class="nav-link text-lg font-medium text-gray-600 hover:text-[#E07A5F] pb-1">Day 4</a>
                </nav>
            </div>
        </div>
    </header>
    
    <nav class="md:hidden bg-white/80 backdrop-blur-lg shadow-sm sticky top-[76px] z-30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-around py-2">
                <a href="#overview" class="nav-link text-sm font-medium text-gray-600 hover:text-[#E07A5F]">總覽</a>
                <a href="#day1" class="nav-link text-sm font-medium text-gray-600 hover:text-[#E07A5F]">Day 1</a>
                <a href="#day2" class="nav-link text-sm font-medium text-gray-600 hover:text-[#E07A5F]">Day 2</a>
                <a href="#day3" class="nav-link text-sm font-medium text-gray-600 hover:text-[#E07A5F]">Day 3</a>
                <a href="#day4" class="nav-link text-sm font-medium text-gray-600 hover:text-[#E07A5F]">Day 4</a>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        <section id="overview" class="scroll-mt-32 mb-16">
            <h2 class="text-2xl sm:text-3xl font-bold text-[#E07A5F] border-b-2 border-[#F2CC8F] pb-2 mb-6">行程總覽</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-[#3D405B]">重要資訊</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <span class="text-2xl mr-4">✈️</span>
                            <div>
                                <h4 class="font-semibold">航班資訊</h4>
                                <p class="text-gray-600">桃園 (TPE) ⇄ 沖繩那霸 (OKA)</p>
                                <p class="text-sm text-gray-500">10/23 出發: 06:50 - 09:20</p>
                                <p class="text-sm text-gray-500">10/26 返程: 16:55 - 17:35</p>
                            </div>
                        </div>
                         <div class="flex items-start">
                            <span class="text-2xl mr-4">🚗</span>
                            <div>
                                <h4 class="font-semibold">租車資訊</h4>
                                <p class="text-gray-600">沖繩OTS租車 (文宇已預訂)</p>
                                <p class="text-sm text-gray-500">10/23 10:00 至 10/26 14:00</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="text-2xl mr-4">👥</span>
                            <div>
                                <h4 class="font-semibold">同行旅伴 (10人)</h4>
                                <p class="text-gray-600">行李託運：冠聞、韋智、1+、朱朱</p>
                            </div>
                        </div>
                    </div>
                </div>
                 <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-[#3D405B]">行程概覽</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <span class="text-2xl mr-4">🏝️</span>
                            <div>
                                <h4 class="font-semibold">10/24 沖繩北部</h4>
                                <p class="text-gray-600">古宇利島</p>
                                <p class="text-sm text-gray-500">系滿魚市場/蝦蝦飯/鳴声以外</p>
                            </div>
                        </div>
                         <div class="flex items-start">
                            <span class="text-2xl mr-4">🐋</span>
                            <div>
                                <h4 class="font-semibold">10/25 沖繩北中部</h4>
                                <p class="text-gray-600">美麗海水族館</p>
                                <p class="text-sm text-gray-500">海邦丸/琉球の牛</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="text-2xl mr-4">🏊</span>
                            <div>
                                <h4 class="font-semibold">10/26 沖繩中南部</h4>
                                <p class="text-gray-600"> 浮潛/國際通</p>
                                <p class="text-sm text-gray-500">肉的變態集團</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="text-2xl mr-4">🛍️</span>
                            <div>
                                <h4 class="font-semibold">10/27 沖繩南部</h4>
                                <p class="text-gray-600">瀨長島/國際通</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div id="itinerary"></div>

    </main>
    
    <script>
        const itineraryData = {
            day1: {
                title: "北部探索之旅",
                date: "10/23 (週四)",
                events: [
                    { time: "06:50 - 09:20", title: "出發", icon: "✈️", description: "桃園機場 → 抵達沖繩那霸機場", notes: "記得檢查護照與機票！ 需要託運的有：冠聞、韋智、1+、朱朱。" },
                    { time: "09:30 - 11:30", title: "機場手續 & 租車", icon: "🚗", description: "領取行李、租車。", notes: "沖繩OTS租車 (10/23 10:00~10/26 14:00)，文宇已預訂。" },
                    { time: "11:30 - 14:00", title: "午餐 & 交通", icon: "🍤", description: "前往系滿魚市場享用早餐，隨後驅車前往沖繩北部享用蝦蝦飯。", notes: "車程約 1 小時 10 分鐘。早午餐：系滿魚市場/蝦蝦飯。<br><a href='https://hanblog.tw/itoman-fish-center/' target='_blank' class='text-[#E07A5F] hover:underline'>系滿魚市場介紹</a><br><a href='https://bobbyfun.tw/2023-04-30-2328/' target='_blank' class='text-[#E07A5F] hover:underline'>蝦蝦飯介紹</a>" },
                    { 
                        time: "14:00 - 17:00", title: "北部景點遊覽", icon: "🏞️", description: "有多個景點，請點選下方按鈕查看。", 
                        options: {
                            '古宇利島': { name: "古宇利島", link: "https://bobbyfun.tw/2024-01-07-2704/", note: "古宇利大橋/海洋塔/心形岩" },
                            '名護鳳梨園': { name: "名護鳳梨園", link: "https://bobbyfun.tw/wp-content/uploads/pixnet/136e4017db89101faa7aaafd230801b4.jpg", note: "鳳梨田/恐龍園區" },
                            'FIFI PARLOR': { name: "下午茶 FIFI PARLOR", link: "https://slowlifeinokinawa.com/okicafe-fifiparlor/", note: "海景咖啡店" },
                            'The Sinmay': { name: "The Sinmay -coffee & tea-", link: "https://www.threads.com/@annyliu0320/post/DO3XC0GEZgj/%E6%B2%96%E7%B9%A9%E9%9A%B1%E8%97%8F%E7%89%88%E7%8F%BE%E5%88%A8%E7%94%9F%E9%BB%91%E7%B3%96%E5%92%96%E5%95%A1%E5%A4%AA%E6%B5%AE%E8%AA%87%E7%8F%BE%E5%89%9D%E9%BB%91%E7%B3%96%E7%A3%9A%E5%8A%A0%E4%B8%8A%E5%86%B0%E6%B7%87%E6%B7%8B%E4%B8%80%E5%85%A5%E5%8F%A3%E6%95%B4%E5%80%8B%E7%88%86%E9%A6%99sinmay-coffee-okinawa-%E8%B6%81%E4%BA%BA%E9%82%84%E4%B8%8D%E5%A4%9A%E5%A4%A7%E5%AE%B6%E5%BF%AB%E4%BE%86%E5%96%9D", note: "現刨生黑糖鮮奶" }
                        } 
                    },
                    { time: "19:00 - 20:00", title: "晚餐", icon: "🐖", description: "うちなー食道 鳴声以外", notes: "阿古豬火鍋/豬排等特色料理。<br><a href='https://www.tripadvisor.jp/Restaurant_Review-g1120808-d14138848-Reviews-Uchina_Shokudo_Nakigoe_Igai-Motobu_cho_Kunigami_gun_Okinawa_Prefecture_Kyushu.html' target='_blank' class='text-[#E07A5F] hover:underline'>鳴声以外介紹</a><br>" },
                    { 
                        time: "After 20:00", title: "入住 & 自由時間", icon: "🏨", description: "入住飯店後為自由時間。", 
                        options: {
                            'Mon Refuge': { name: "Mon Refuge Prive", link: "https://www.booking.com/hotel/jp/mon-refuge-prive-si-noyin-rejia.zh-tw.html?aid=2311236", note: "靠近水族館" }
                        },
                        notes: "晚上活動：遊戲競賽，贏家獎品隔天免費燒肉 (10000日圓內)。"
                    },
                    { time: "宵夜/酒吧", title: "夜生活", icon: "🍻", description: "可選擇前往居酒屋或酒吧。", notes: "居酒屋參考：<a href='https://maps.app.goo.gl/1PAx4h3yWZLeJ5Ju6' target='_blank' class='text-[#E07A5F] hover:underline'>豚と寿司の島居酒屋</a>" }
                ]
            },
            day2: {
                title: "海洋與美食之旅",
                date: "10/24 (週五)",
                events: [
                    { time: "08:30 - 12:00", title: "美麗海水族館", icon: "🐠", description: "探索神秘的海底世界。", notes: "必看：10:00-10:30 餵食海豚海龜；10:30/11:30 海豚秀。" },
                    { 
                        time: "12:00 - 14:00", title: "午餐時間", icon: "🍜", description: "水族館周邊有多樣化的午餐選擇。", 
                        options: {
                            '海邦丸': { name: "海人料理 海邦丸 (海鮮定食)", link: "https://www.google.com/maps/place/%E6%B5%B7%E4%BA%BA%E6%96%99%E7%90%86+%E6%B5%B7%E9%82%A6%E4%B8%B8/@26.6875317,127.8745423,15.75z/data=!4m22!1m15!4m14!1m6!1m2!1s0x34e4fa3152619e3d:0xea08a6700fdd9ffe!2z5rKW57mp576O6bqX5rW35rC05peP6aSoIOaXpeacrOOAkjkwNS0wMjA2IE9raW5hd2EsIEt1bmlnYW1pIERpc3RyaWN0LCBNb3RvYnUsIElzaGlrYXdhLCA0MjQ!2m2!1d127.8780131!2d26.694338!1m6!1m2!1s0x34e4fbd207cf9a83:0x5e5c187da072999b!2z5rW35Lq65paZ55CGIOa1t-mCpuS4uCDml6XmnKzjgJI5MDUtMDIwNSBPa2luYXdhLCBLdW5pZ2FtaSBEaXN0cmljdCwgTW90b2J1LCBZYW1hZ2F3YSwgMTQyMS0x!2m2!1d127.8836417!2d26.682195!3m5!1s0x34e4fbd207cf9a83:0x5e5c187da072999b!8m2!3d26.682195!4d127.8836417!16s%2Fg%2F1td0w6nl", note: "" },
                            '海上觀景餐廳INOH': { name: "海上觀景餐廳INOH", link: "https://i17fun.tw/inoh/", note: "位於美麗海水族館4樓,成人價格約為2,200日圓吃到飽，還能一邊用餐一邊欣賞美麗海景" },
                            '岸本食堂': { name: "岸本食堂 (百年沖繩麵)", link: "https://www.google.com/maps/place/%E5%B2%B8%E6%9C%AC%E9%A3%9F%E5%A0%82/@26.6761861,127.8660123,14z/data=!4m23!1m15!4m14!1m6!1m2!1s0x34e4fa3152619e3d:0xea08a6700fdd9ffe!2z5rKW57mp576O6bqX5rW35rC05peP6aSoIOaXpeacrOOAkjkwNS0wMjA2IE9raW5hd2EsIEt1bmlnYW1pIERpc3RyaWN0LCBNb3RvYnUsIElzaGlrYXdhLCA0MjQ!2m2!1d127.8780131!2d26.694338!1m6!1m2!1s0x34e4f95eb431867d:0x1653b48af7640a31!2z5bK45pys6aOf5aCCIOaXpeacrOOAkjkwNS0wMjE0IE9raW5hd2EsIEt1bmlnYW1pIERpc3RyaWN0LCBNb3RvYnUsIOacrOmDqOeUulRvZ3VjaGksIDU!2m2!1d127.8958949!2d26.6603253!3m6!1s0x34e4f95eb431867d:0x1653b48af7640a31!8m2!3d26.6603253!4d127.8958949!10e9!16s%2Fg%2F1tfn0h3y", note: "" },
                            '島豚家': { name: "島豚家 (限量炙烤島豬麵)", link: "https://www.google.com/maps/place/Island+Pig+House/@26.6900872,127.8785653,15.75z/data=!3m1!5s0x34e4fa331411ea83:0xa075f02c5f1d5747!4m23!1m15!4m14!1m6!1m2!1s0x34e4fa3152619e3d:0xea08a6700fdd9ffe!2z5rKW57mp576O6bqX5rW35rC05peP6aSoIOaXpeacrOOAkjkwNS0wMjA2IE9raW5hd2EsIEt1bmlnYW1pIERpc3RyaWN0LCBNb3RvYnUsIElzaGlrYXdhLCA0MjQ!2m2!1d127.8780131!2d26.694338!1m6!1m2!1s0x34e4f95cc7f9bf7f:0xb37a97d151c8e3c0!2zSXNsYW5kIFBpZyBIb3VzZSwgNDc555Wq5ZywIFRveW9oYXJhLCBNb3RvYnUsIEt1bmlnYW1pIERpc3RyaWN0LCBPa2luYXdhIDkwNS0wMjA05pel5pys!2m2!1d127.8921072!2d26.6901511!3m6!1s0x34e4f95cc7f9bf7f:0xb37a97d151c8e3c0!8m2!3d26.6901511!4d127.8921072!10e9!16s%2Fg%2F1tj875cl", note: "每日限量50碗。" }
                        }
                    },
                    { 
                        time: "下午", title: "中部景點遊覽", icon: "🏞️", description: "有多個景點，請點選下方按鈕查看。", 
                        options: {
                            '美國村': { name: "美國村", link: "https://bobbyfun.tw/2024-03-05-3072/#1_%E7%BE%8E%E5%9C%8B%E6%9D%91", note: "沖繩No.1娛樂型購物區－集購物、美食、海灘魅力於一身" },
                            '永旺夢樂城': { name: "永旺夢樂城沖繩來客夢", link: "https://bobbyfun.tw/2024-01-07-2699/", note: "超過百家知名品牌店鋪" },
                            '殘波岬': { name: "殘波岬燈塔", link: "https://bobbyfun.tw/2024-01-07-2691/", note: "能欣賞沖繩本島最後一道落霞的夕陽名所" }
                        } 
                    },
                    { time: "晚上", title: "晚餐：燒肉！", icon: "🥩", description: "琉球の牛 恩納店，已分批預約。", notes: "預計 20:00。預約碼：9A77JL, ECST64, YDFWSK。<br><a href='https://bobbyfun.tw/2023-05-01-2338/' target='_blank' class='text-[#E07A5F] hover:underline'>琉球的牛介紹</a>" },
                    { time: "晚上", title: "入住 & 休息", icon: "🏨", description: "TERRACE GARDEN OKINAWA", notes: "中部飯店<br><a href='https://www.agoda.com/terrace-garden-okinawa-h10943499/hotel/okinawa-main-island-jp.html' target='_blank' class='text-[#E07A5F] hover:underline'>訂房連結</a>" },
                ]
            },
            day3: {
                title: "動感與悠閒之旅",
                date: "10/25 (週六)",
                events: [
                    { time: "上午", title: "水上活動：浮潛", icon: "🤿", description: "前往沖繩藍 (青之洞窟) 體驗浮潛。", notes: "時間：08:00 - 10:00，文宇已預訂。" },
                    { time: "中午", title: "午餐時間", icon: "🍽️", description: "午餐待定，可依據浮潛後的地點決定。", notes: "" },
                    { 
                        time: "下午", title: "南部景點遊覽", icon: "🏞️", description: "有多個景點，請點選下方按鈕查看。", 
                        options: {
                            '國際通': { name: "國際通", link: "https://bobbyfun.tw/2024-01-08-2708/", note: "沖繩最繁華商業街、伴手禮聖地" },
                            '第一牧志公設市場': { name: "牧志市場有沖繩人廚房之稱", link: "https://bobbyfun.tw/2024-01-07-2705/", note: "在一樓挑選自己滿意的食材，還可以請二樓餐廳幫忙料理現吃，非常有趣的日本市場體驗" },
                            'PARCO CITY': { name: "PARCO CITY 購物聖地", link: "https://bobbyfun.tw/2024-01-07-2705/", note: "沖繩無敵海景購物聖地" },
                            '玉泉洞': { name: "沖繩世界文化王國", link: "https://bobbyfun.tw/2024-01-11-2733/", note: "沖繩世界文化王國的「玉泉洞」是日本第二大鐘乳石洞窟" },
                            '波上宮': { name: "懸崖上的絕美神社", link: "https://bobbyfun.tw/2024-01-07-2698/", note: "沖繩八社之首、有沖繩總鎮守之稱，為沖繩最具代表性的神社" }
                        } 
                    },
                    { time: "晚上", title: "市區探索：國際通", icon: "🛍️", description: "自由活動，晚餐可在此解決。", notes: "晚餐：<a href='https://autoreserve.com/zh-hk/restaurants/W2w2Ro8TcnG5hVNxXw4P' target='_blank' class='text-[#E07A5F] hover:underline'>肉的變態集團</a> (冠聞/文宇/韋智/姵汝)。<br>點心：blue sea 冰店。可考慮逛美國村。" },
                    { time: "晚上", title: "入住 & 休息", icon: "🏨", description: "Naha Miharanosato -SEVEN Hotels and Resorts", notes: "<br><a href='https://www.agoda.com/zh-tw/naha-miharanosato-seven-hotels-and-resorts/hotel/okinawa-main-island-jp.html' target='_blank' class='text-[#E07A5F] hover:underline'>訂房連結</a>" }
                ]
            },
            day4: {
                title: "購物與歸途",
                date: "10/26 (週日)",
                events: [
                    { time: "早上", title: "最後巡禮", icon: "🏝️", description: "可選擇前往瀨長島或在國際通繼續購物。", notes: "瀨長島假日可能容易塞車，需注意交通時間。" },
                    { time: "中午", title: "午餐 & 逛街", icon: "🎁", description: "在國際通享用午餐並進行最後的採購。", notes: "" },
                    { time: "下午", title: "前往機場", icon: "🚗", description: "準備還車並辦理登機手續。", notes: "記得預留充足時間。" },
                    { time: "16:55 - 17:35", title: "返程", icon: "✈️", description: "沖繩那霸機場 → 抵達桃園國際機場", notes: "滿載而歸！" }
                ]
            }
        };

        const itineraryContainer = document.getElementById('itinerary');
        Object.keys(itineraryData).forEach(dayKey => {
            const dayData = itineraryData[dayKey];
            const section = document.createElement('section');
            section.id = dayKey;
            section.className = "day-section scroll-mt-32 mb-12 hidden";
            
            let eventsHtml = '';
            dayData.events.forEach((event, index) => {
                let optionsHtml = '';
                if (event.options) {
                    const optionKeys = Object.keys(event.options);
                    const tabsHtml = optionKeys.map((key, i) => `<button class="option-tab ${i === 0 ? 'active' : ''}" data-target="${dayKey}-event${index}-option${i}">${key}</button>`).join('');
                    const contentsHtml = optionKeys.map((key, i) => {
                        const option = event.options[key];
                        return `<div id="${dayKey}-event${index}-option${i}" class="option-content ${i > 0 ? 'hidden' : ''} mt-4 p-4 bg-[#F4F1DE]/60 rounded-lg">
                                    <h5 class="font-semibold">${option.name}</h5>
                                    ${option.note ? `<p class="text-sm text-gray-600 mt-1">${option.note}</p>` : ''}
                                    ${option.link ? `<a href="${option.link}" target="_blank" class="text-sm text-[#E07A5F] hover:underline mt-2 inline-block">查看詳情 →</a>` : ''}
                                </div>`;
                    }).join('');
                    optionsHtml = `<div class="mt-4">
                                        <div class="flex flex-wrap gap-2">${tabsHtml}</div>
                                        <div>${contentsHtml}</div>
                                    </div>`;
                }
                
                eventsHtml += `
                    <div class="timeline-item relative pl-8 pb-8">
                        <div class="timeline-icon text-base sm:text-xl">${event.icon}</div>
                        <p class="text-sm font-medium text-[#E07A5F]">${event.time}</p>
                        <h4 class="text-lg sm:text-xl font-bold mt-1 text-[#3D405B]">${event.title}</h4>
                        <p class="text-gray-700 mt-2">${event.description}</p>
                        ${event.notes ? `<div class="mt-2 text-sm text-gray-500 bg-[#F4F1DE]/60 p-3 rounded-md">${event.notes}</div>` : ''}
                        ${optionsHtml}
                    </div>
                `;
            });

            // ** MODIFIED START: Added padding to the timeline container on mobile **
            section.innerHTML = `
                <div class="flex items-baseline mb-6">
                     <h2 class="text-2xl sm:text-3xl font-bold text-[#E07A5F] mr-4">Day ${dayKey.slice(-1)}</h2>
                     <p class="text-lg sm:text-xl font-medium text-gray-500">${dayData.date} - ${dayData.title}</p>
                </div>
                <div class="relative pl-4 sm:pl-0">${eventsHtml}</div>
            `;
            // ** MODIFIED END **
            itineraryContainer.appendChild(section);
        });

        // Event listener for inner option tabs (unchanged)
        itineraryContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('option-tab')) {
                const targetId = e.target.dataset.target;
                const parent = e.target.closest('.timeline-item');
                parent.querySelectorAll('.option-tab').forEach(tab => tab.classList.remove('active'));
                e.target.classList.add('active');
                parent.querySelectorAll('.option-content').forEach(content => content.classList.add('hidden'));
                document.getElementById(targetId).classList.remove('hidden');
            }
        });
        
        // --- LOGIC FOR MAIN DAY TABS ---

        // Select all main navigation links from both nav bars
        const mainNavLinks = document.querySelectorAll('header .nav-link, nav.md\\:hidden .nav-link');
        
        // Show the '總覽' (Overview) section and set its nav link to active by default
        document.getElementById('overview').classList.remove('hidden');
        mainNavLinks.forEach(link => {
            if (link.getAttribute('href') === '#overview') {
                link.classList.add('active');
            } else {
                link.classList.remove('active');
            }
        });

        // Add click listener for main day navigation to switch tabs
        mainNavLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);

                if (!targetSection) return;

                // Hide all main sections (overview and all day-sections)
                document.querySelectorAll('#overview, .day-section').forEach(section => {
                    section.classList.add('hidden');
                });

                // Show the clicked section
                targetSection.classList.remove('hidden');

                // Update active state for all nav links (both mobile and desktop)
                const targetHref = link.getAttribute('href');
                mainNavLinks.forEach(navLink => {
                    if (navLink.getAttribute('href') === targetHref) {
                        navLink.classList.add('active');
                    } else {
                        navLink.classList.remove('active');
                    }
                });
            });
        });

        // Chart.js logic (unchanged)
        const ctx = document.getElementById('budgetChart').getContext('2d');
        const budgetChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['住宿', '交通', '餐飲', '活動 & 門票', '購物 & 其他'],
                datasets: [{
                    label: '預算分配',
                    data: [35000, 25000, 20000, 15000, 10000],
                    backgroundColor: ['#3D405B', '#81B29A', '#E07A5F', '#F2CC8F', '#F4F1DE'],
                    borderColor: '#F8F7F4',
                    borderWidth: 4,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { font: { family: "'Inter', 'Noto Sans TC', sans-serif" } }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed !== null) {
                                    label += new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(context.parsed);
                                }
                                return label;
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    </script>
</body>
</html>